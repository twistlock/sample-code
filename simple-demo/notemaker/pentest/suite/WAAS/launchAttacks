#!/bin/bash

function usage {
  # echo "you must pass in 'all' or one or more of web|css|mysql|blind|pw|local|malformed"
  exit
}

[ "$#" -lt 1 ] && usage 
runit=$(echo $1 | egrep 'all|web|css|mysql|blind|pw|local|malformed')
[[ -z $runit ]] && usage 

echo "========================================================="
echo "====  PENTEST: WEB CONTAINER OWASP TOP 10 ATTACKS   ====="
echo "========================================================="
echo

op=$1
did=false

[[ "$op" == *"web"* ]] && op=all

[[ ("$op" == *"all"* || "$op" == *"css"*) ]] && did=true && cssAttack

[[ ("$op" == *"all"* || "$op" == *"mysql"*) ]] && did=true && MYSQLInjection 

[[ ("$op" == *"all"* || "$op" == *"blind"*) ]] && did=true && blindSQLInjection 

[[ ("$op" == *"all"* || "$op" == *"pw"*) ]] && did=true && getCredentialsInjectionAttack 

# [[ ("$op" == *"all"* || "$op" == *"upload"*) ]] && did=true && fileUploadAttack

[[ ("$op" == *"all"* || "$op" == *"local"*) ]] && did=true && localFileInclusionAttack 

[[ ("$op" == *"all"* || "$op" == *"malformed"*) ]] && did=true && malformedHTTPRequest 

[[ ("$WAITFORKEY" == "true"  && "$did" == "true") ]] && echo "hit a key to continue" && read -r -n1 key

 
